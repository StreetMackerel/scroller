<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<style>
canvas {
    border: 1px solid #d3d3d3;
    background-color: #000000;
}
    
body {
    text-align: center;
    align-content: center;
    background-color: #c1c1c1;
    margin-top: 20px;
}


</style>
</head>
<body onload="startGame()">
<script>

var walls = [];
var gaps = [];


    
function startGame() {
    myGameArea.menu();
    player = new item(30, 30, "red", 60, 120);
}
    
var myGameArea = {
  canvas : document.createElement("canvas"),
    
  start : function() {
    this.interval = setInterval(updateGameArea, 15);
  },
  clear : function() {
    this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);
  },
  gameOver : function() {
    clearInterval(this.interval);
    window.alert("GAME OVER! refresh the page to try again");
    
  },
  menu : function() {
    
    this.canvas.width = 950;
    this.canvas.height = 500;
    this.context = this.canvas.getContext("2d");
    document.body.insertBefore(this.canvas, document.body.childNodes[0]);
    this.frameNo = 0;
      
    this.context.font = "80px Courier";
    this.context.fillStyle = 'green';
    this.context.fillText("HOVER GAME", 250, 200);
    
    var buttonX = 350;
    var buttonY = 300;
    var buttonW = 250;
    var buttonH = 150;
    this.context.fillStyle = 'red';
    this.context.fillRect(buttonX, buttonY, buttonW, buttonH);
    this.context.fillStyle = 'black';
    this.context.fillRect(buttonX+5, buttonY+5, buttonW-10, buttonH-10);
    this.context.fillStyle = 'red';
    this.context.font = "36px Courier";
    this.context.fillText("Start Game", buttonX+17, buttonY+85);
    this.canvas.addEventListener('click', function(event) {
    if (
        event.x > buttonX && 
        event.x < buttonX + buttonW &&
        event.y > buttonY && 
        event.y < buttonY + buttonH
      ) {
        myGameArea.start();
      }
    });
  }
}
    
var canvasWidth = myGameArea.canvas.width;
var canvasHieght = myGameArea.canvas.hieght;
    
addEventListener( "keydown", doKeyDown, true);
addEventListener( "keyup", doKeyUp, true);
    
function wall(width, height, color, x, y) {
  this.width = width;
  this.height = height;
  this.x = x;
  this.y = y; 
  this.update = function(){
    ctx = myGameArea.context;
    ctx.fillStyle = color;
    ctx.fillRect(this.x, this.y, this.width, this.height);
  }
}

function gap(width, height, color, x, y) {
  this.width = width;
  this.height = height;
  this.x = x;
  this.y = y; 
  this.update = function(){
    ctx = myGameArea.context;
    ctx.fillStyle = color;
    ctx.fillRect(this.x, this.y, this.width, this.height);
  }
}
    
function item(width, height, color, x, y) {
  this.width = width;
  this.height = height;
  this.x = x;
  this.y = y; 
  this.speedX = 0;
  this.speedY = 0;
  this.gravity = 0.25;
  this.gravitySpeed = 0;
  this.bounce = 0.6;
  this.update = function(){
    ctx = myGameArea.context;
    ctx.fillStyle = color;
    ctx.fillRect(this.x, this.y, this.width, this.height);
  }
    this.move = function() {
    this.gravitySpeed += this.gravity;
    this.x += this.speedX;
    this.y += this.speedY + this.gravitySpeed;
    if(this.y > 470){
        this.y =  470;
        this.gravitySpeed = -(this.gravitySpeed * this.bounce);
    }
  }
  this.collide = function(object) {
    var myleft = this.x;
    var myright = this.x + (this.width);
    var mytop = this.y;
    var mybottom = this.y + (this.height);
    var otherleft = object.x;
    var otherright = object.x + (object.width);
    var othertop = object.y;
    var otherbottom = object.y + (object.height);
    var collision = true;
    if ((mybottom < othertop) ||
    (mytop > otherbottom) ||
    (myright < otherleft) ||
    (myleft > otherright)) {
      collision = false;
    }
    return collision;
  }
}

function time(n) {
  if ((myGameArea.frameNo / n) % 1 == 0) {
      return true;
  }
  return false;
}

function accelerate(n) {
    player.gravity = n;
}

var wallSpeed = 2;
var spawnRate = 60;
var level = -1;
var score = 0;
    
function updateGameArea() {

var x, y;

var minHeight = 50;
var maxHeight = 220;
var height;
    
if (time(500)) {
    wallSpeed +=2;
    spawnRate -=4;
    level+=1;
    document.getElementById("level").innerHTML = level;
}
if (time(10)){
    score++
    document.getElementById("score").innerHTML = score;
}

    
for (i = 0; i < walls.length; i += 1) {
    if (player.collide(walls[i])) {
        ctx = myGameArea.context;
        myGameArea.gameOver();
    }
}
    
myGameArea.clear();
myGameArea.frameNo += 1;
            
if (myGameArea.frameNo == 1 || time(spawnRate)) {
    x = myGameArea.canvas.width;
    height = Math.floor(Math.random()*(maxHeight-minHeight)+minHeight);
    walls.push(new wall(100, height, "green", x, 0));
    gaps.push(new gap(100, 250, "black", x, height));
    walls.push(new wall(100,  500, "green", x, height+250));
    console.log(height);
    }

for (i = 0; i < walls.length; i += 1) {
        walls[i].x -= wallSpeed;
        walls[i].update();
}
    
for (i = 0; i < gaps.length; i += 1) {
        gaps[i].x -= wallSpeed;
        gaps[i].update();
}
      
player.move();
player.update();

    
}

function doKeyUp(e){

			if (e.keyCode == 32) {
				accelerate(0.15); 
                console.log("pressing");
			}

		}
function doKeyDown(e){
    
			if (e.keyCode == 32) {
				accelerate(-0.4); 
			}

		}
</script>
    <h1>PRESS AND HOLD SPACEBAR TO HOVER</h1> 
    <h2><b>SPEED LEVEL: <a id="level">0</a></b></h2>
    <h2><b>SCORE: <a id="score">0</a></b></h2>
</body>
</html>

